# 実装計画

- [ ] 1. プロジェクト基盤とコア構造の設定

  - Next.js + TypeScript プロジェクトの初期化
  - FastAPI バックエンドプロジェクトの初期化
  - 基本的なディレクトリ構造とコア型定義の作成
  - _要件: 1.1, 4.1_

- [ ] 2. データモデルとインターフェースの実装
- [ ] 2.1 TypeScript 型定義とインターフェースの作成

  - Character, PassiveSkill, DamageCalculationRequest, DamageCalculationResult インターフェースの実装
  - 型安全性を確保するための検証関数の作成
  - _要件: 1.2, 1.3, 2.2_

- [ ] 2.2 Pydantic データモデルの実装

  - バックエンド用のデータモデルクラスの作成
  - 入力検証とシリアライゼーション機能の実装
  - _要件: 4.4, 5.3_

- [ ] 3. 外部 API 統合クライアントの実装
- [ ] 3.1 外部キャラクター API クライアントの作成

  - HTTP クライアント (httpx) を使用した API 通信機能の実装
  - タイムアウト、リトライ、エラーハンドリング機能の実装
  - _要件: 1.4, 5.1, 5.5_

- [ ] 3.2 キャラクターデータ取得・正規化機能の実装

  - 外部 API レスポンスの検証と正規化処理の実装
  - キャラクターデータのキャッシュ機能の実装
  - _要件: 5.3, 5.4_

- [ ] 4. パッシブスキル計算エンジンの実装
- [ ] 4.1 基本パッシブスキル計算関数の作成

  - 防御力ブースト、ダメージ軽減、ガード能力の計算関数を実装
  - モジュラー設計でスキルタイプ別の処理を分離
  - _要件: 2.2, 5.2, 6.3_

- [ ] 4.2 DEF 無限上昇計算機能の実装

  - スタッキング防御力の段階的計算機能を実装
  - 攻撃回数に基づく防御力増加の処理を実装
  - _要件: 2.3, 6.1, 6.2_

- [ ] 5. ダメージ計算コアロジックの実装
- [ ] 5.1 実効防御力計算機能の実装

  - DEF ステータス、リーダースキル倍率、パッシブスキルを統合した計算処理
  - 複数の修正値を正しい順序で適用する機能
  - _要件: 2.1, 2.2, 6.3_

- [ ] 5.2 最終ダメージ計算機能の実装

  - 実効防御力と敵アタック値の比較処理
  - ダメージ値の計算とエッジケース処理（ゼロダメージ、マイナス値処理）
  - _要件: 3.1, 3.2, 3.3, 3.4_

- [ ] 6. FastAPI バックエンド API の実装
- [ ] 6.1 ダメージ計算 API エンドポイントの作成

  - POST /api/calculate-damage エンドポイントの実装
  - リクエスト検証とレスポンス形式の実装
  - _要件: 4.1, 4.3, 4.4_

- [ ] 6.2 キャラクター取得 API エンドポイントの作成

  - GET /api/characters エンドポイントの実装
  - 外部 API 統合とエラーハンドリングの実装
  - _要件: 1.4, 5.1, 5.5_

- [ ] 7. Next.js フロントエンドコンポーネントの実装
- [ ] 7.1 キャラクター選択コンポーネントの作成

  - CharacterSelector コンポーネントの実装
  - 検索・フィルタリング機能とローディング状態の実装
  - _要件: 1.4, 5.4_

- [ ] 7.2 ダメージ計算フォームコンポーネントの作成

  - DamageCalculatorForm コンポーネントの実装
  - 入力検証とリアルタイムフィードバック機能の実装
  - _要件: 1.1, 1.2, 1.3, 1.5_

- [ ] 7.3 結果表示コンポーネントの作成

  - DamageResultDisplay コンポーネントの実装
  - 計算結果の詳細表示とスタッキングキャラクター対応
  - _要件: 3.5, 6.5_

- [ ] 8. エラーハンドリングとユーザーエクスペリエンスの実装
- [ ] 8.1 フロントエンドエラーハンドリングの実装

  - API 通信エラーの処理とユーザーフィードバック
  - トースト通知とリトライ機能の実装
  - _要件: 5.4, 5.5_

- [ ] 8.2 バックエンドエラーハンドリングの実装

  - 外部 API 障害時の適切なエラーレスポンス
  - 統一されたエラーレスポンス形式の実装
  - _要件: 5.1, 5.5_

- [ ] 9. テスト実装
- [ ] 9.1 バックエンド単体テストの作成

  - ダメージ計算ロジックのテストケース作成
  - 外部 API 統合のモックテスト実装
  - _要件: 2.1, 2.2, 2.3, 3.1, 3.2, 3.3_

- [ ] 9.2 フロントエンド単体テストの作成

  - React コンポーネントのテストケース作成
  - ユーザーインタラクションのテスト実装
  - _要件: 1.1, 1.2, 1.3, 1.4, 1.5_

- [ ] 10. 統合とデプロイ準備
- [ ] 10.1 フロントエンド・バックエンド統合テストの実装

  - エンドツーエンドの API 通信テスト
  - 実際の外部 API を使用した統合テスト
  - _要件: 4.1, 4.2, 4.3, 4.4, 4.5_

- [ ] 10.2 本番環境設定とデプロイ準備
  - 環境変数設定とセキュリティ設定の実装
  - Vercel (フロントエンド) と Railway/Heroku (バックエンド) のデプロイ設定
  - _要件: 4.5_
